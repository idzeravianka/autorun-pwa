"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6798],{6798:(M,l,r)=>{r.r(l),r.d(l,{SettingsModule:()=>D});var m=r(6895),u=r(433),i=r(2723),p=r(9430),g=r(5861),a=r(2076),_=r(5698),t=r(1571),d=r(7019);function f(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 "),t.qZA())}function C(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f "),t.qZA())}function F(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 "),t.qZA())}function v(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f "),t.qZA())}function h(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 "),t.qZA())}function Z(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f "),t.qZA())}function T(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 "),t.qZA())}function x(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f "),t.qZA())}function q(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 "),t.qZA())}function A(o,e){1&o&&(t.TgZ(0,"ion-note",15),t._uU(1," \u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f "),t.qZA())}function E(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t._uU(2,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),t.qZA(),t.TgZ(3,"ion-list",3)(4,"ion-item",4)(5,"ion-label",5),t._uU(6,"\u0421\u0435\u0440\u0432\u0435\u0440 (MQTT broker):"),t.qZA(),t._UZ(7,"ion-input",6),t.YNc(8,f,2,0,"ion-note",7),t.YNc(9,C,2,0,"ion-note",7),t.qZA(),t.TgZ(10,"ion-item",4)(11,"ion-label",5),t._uU(12,"\u041f\u043e\u0440\u0442 (MQTT port):"),t.qZA(),t._UZ(13,"ion-input",8),t.YNc(14,F,2,0,"ion-note",7),t.YNc(15,v,2,0,"ion-note",7),t.qZA(),t.TgZ(16,"ion-item",4)(17,"ion-label",5),t._uU(18,"\u041b\u043e\u0433\u0438\u043d (MQTT user):"),t.qZA(),t._UZ(19,"ion-input",9),t.YNc(20,h,2,0,"ion-note",7),t.YNc(21,Z,2,0,"ion-note",7),t.qZA(),t.TgZ(22,"ion-item",4)(23,"ion-label",5),t._uU(24,"\u041f\u0430\u0440\u043e\u043b\u044c (MQTT password):"),t.qZA(),t._UZ(25,"ion-input",10),t.YNc(26,T,2,0,"ion-note",7),t.YNc(27,x,2,0,"ion-note",7),t.qZA(),t.TgZ(28,"ion-item",4)(29,"ion-label",5),t._uU(30,"\u041f\u0440\u0435\u0444\u0438\u043a\u0441 \u0442\u043e\u043f\u0438\u043a\u0430 (prefix):"),t.qZA(),t._UZ(31,"ion-input",11),t.YNc(32,q,2,0,"ion-note",7),t.YNc(33,A,2,0,"ion-note",7),t.qZA()(),t.TgZ(34,"div",3)(35,"ion-button",12),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.showConfirmationDialog())}),t._uU(36,"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"),t.qZA(),t.TgZ(37,"ion-button",13),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.saveSettings())}),t._uU(38,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),t.qZA()(),t.TgZ(39,"div",14),t._uU(40," \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c\u044b\u0435 MQTT \u0441\u0435\u0440\u0432\u0435\u0440\u0430: wqtt.ru, clusterfly.ru, cloudmqtt.com. "),t.qZA()()}if(2&o){const n=t.oxw();t.Q6J("formGroup",n.settingsForm),t.xp6(8),t.Q6J("ngIf",(null==n.settingsForm.controls.server.errors?null:n.settingsForm.controls.server.errors.pattern)&&n.settingsForm.controls.server.touched),t.xp6(1),t.Q6J("ngIf",(null==n.settingsForm.controls.server.errors?null:n.settingsForm.controls.server.errors.required)&&n.settingsForm.controls.server.touched),t.xp6(5),t.Q6J("ngIf",(null==n.settingsForm.controls.port.errors?null:n.settingsForm.controls.port.errors.pattern)&&n.settingsForm.controls.port.touched),t.xp6(1),t.Q6J("ngIf",(null==n.settingsForm.controls.port.errors?null:n.settingsForm.controls.port.errors.required)&&n.settingsForm.controls.port.touched),t.xp6(5),t.Q6J("ngIf",(null==n.settingsForm.controls.user.errors?null:n.settingsForm.controls.user.errors.pattern)&&n.settingsForm.controls.user.touched),t.xp6(1),t.Q6J("ngIf",(null==n.settingsForm.controls.user.errors?null:n.settingsForm.controls.user.errors.required)&&n.settingsForm.controls.user.touched),t.xp6(5),t.Q6J("ngIf",(null==n.settingsForm.controls.pass.errors?null:n.settingsForm.controls.pass.errors.pattern)&&n.settingsForm.controls.pass.touched),t.xp6(1),t.Q6J("ngIf",(null==n.settingsForm.controls.pass.errors?null:n.settingsForm.controls.pass.errors.required)&&n.settingsForm.controls.pass.touched),t.xp6(5),t.Q6J("ngIf",(null==n.settingsForm.controls.topic.errors?null:n.settingsForm.controls.topic.errors.pattern)&&n.settingsForm.controls.topic.touched),t.xp6(1),t.Q6J("ngIf",(null==n.settingsForm.controls.topic.errors?null:n.settingsForm.controls.topic.errors.required)&&n.settingsForm.controls.topic.touched)}}const S=[{path:"",component:(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["az-settings"]],decls:2,vars:0,template:function(n,s){1&n&&(t.TgZ(0,"ion-content"),t._UZ(1,"ion-router-outlet"),t.qZA())},dependencies:[i.W2,i.jP]}),o})(),children:[{path:"",component:(()=>{class o{constructor(n){this.navController=n}navigateTo(n){this.navController.navigateForward(n)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(i.SH))},o.\u0275cmp=t.Xpm({type:o,selectors:[["az-menu"]],decls:3,vars:0,consts:[[1,"settings-menu"],[1,"settings-menu__button",3,"click"]],template:function(n,s){1&n&&(t.TgZ(0,"div",0)(1,"ion-button",1),t.NdJ("click",function(){return s.navigateTo("settings/connection")}),t._uU(2,"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435"),t.qZA()())},dependencies:[i.YG],styles:[".settings-menu[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;justify-content:center;align-items:center;row-gap:10px;height:calc(100vh - 48px);padding:15px}.settings-menu__button[_ngcontent-%COMP%]{width:90%}"]}),o})(),pathMatch:"full"},{path:"connection",component:(()=>{class o{constructor(n,s){this.mqttService=n,this.actionSheetCtrl=s}ngOnInit(){this.initSettingsForm()}saveSettings(){this.settingsForm.markAllAsTouched(),this.settingsForm.invalid||this.mqttService.saveMqttSettings(this.settingsForm.value)}showConfirmationDialog(){var n=this;return(0,g.Z)(function*(){const s=yield n.actionSheetCtrl.create({header:"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f?",buttons:[{text:"\u0414\u0430",role:"confirm"},{text:"\u041d\u0435\u0442",role:"cancel"}]});yield s.present(),(0,a.D)(s.onWillDismiss()).pipe((0,_.q)(1)).subscribe(({role:c})=>{"confirm"===c&&n.resetForm()})})()}resetForm(){this.mqttService.clearMqttConnectionSettings(),this.settingsForm.reset()}initSettingsForm(){const n=this.mqttService.getMqttSavedSettings()?JSON.parse(this.mqttService.getMqttSavedSettings()):null;this.settingsForm=new u.cw({server:new u.NI((null==n?void 0:n.server)||null,[u.kI.required,u.kI.pattern("^[a-zA-Z\\.0-9]+$")]),port:new u.NI((null==n?void 0:n.port)||null,[u.kI.required,u.kI.pattern("[0-9]{0,10}")]),user:new u.NI((null==n?void 0:n.user)||null,[u.kI.required]),pass:new u.NI((null==n?void 0:n.pass)||null,[u.kI.required]),topic:new u.NI((null==n?void 0:n.topic)||null,[u.kI.required])})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(d.K),t.Y36(i.BX))},o.\u0275cmp=t.Xpm({type:o,selectors:[["az-connection"]],decls:2,vars:1,consts:[["class","settings",3,"formGroup",4,"ngIf"],[1,"settings",3,"formGroup"],[1,"settings__title"],[1,"settings__field"],[1,"ion-no-padding"],["position","floating","color","primary"],["formControlName","server","placeholder","srv2.clusterfly.ru"],["slot","error",4,"ngIf"],["formControlName","port","placeholder","9994"],["formControlName","user","placeholder","user"],["type","password","formControlName","pass","placeholder","qwerty"],["formControlName","topic","placeholder","user_12345678/c5"],["fill","outline",1,"settings__button",3,"click"],[1,"settings__button",3,"click"],[1,"settings__prompt"],["slot","error"]],template:function(n,s){1&n&&(t.TgZ(0,"ion-content"),t.YNc(1,E,41,11,"div",0),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",!!s.settingsForm))},dependencies:[m.O5,u.JJ,u.JL,u.sg,u.u,i.YG,i.W2,i.pK,i.Ie,i.Q$,i.q_,i.uN,i.j9],styles:[".settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.settings__title[_ngcontent-%COMP%]{padding:15px 0;font-size:16px;font-weight:700}.settings__field[_ngcontent-%COMP%]{width:80%;max-width:350px;margin-bottom:15px}.settings__button[_ngcontent-%COMP%]{width:46%}.settings__button[_ngcontent-%COMP%]:first-child{margin-right:2%}.settings__button[_ngcontent-%COMP%]:last-child{margin-left:2%}.settings__prompt[_ngcontent-%COMP%]{width:80%;max-width:350px;margin-top:15px;color:rgba(0,0,0,.54);text-align:center}"]}),o})()}]}];let B=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.Bz.forChild(S),p.Bz]}),o})(),D=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,B,u.UX,u.u5,i.Pc]}),o})()}}]);